##Autenticar Usuario###
users.authenticate = SELECT U.numeroId,U.idDocumento,U.nombresUsuario,U.apellidosUsuario,U.emailUsuario,U.telefonoUsuario,U.telefono2Usuario,U.celularUsuario,U.usuario,U.contrasena,U.preguntaSeguridad,U.respuestaSeguridad,U.estado as estadoUsuario,P.idPerfil,P.nombrePerfil,P.estado,P.GuardarUsuariao,P.BuscarUsuario,P.ModificarUsuario,P.EliminarUsuario,P.GuardarPerfil,P.BuscarPerfil,P.ModificarPerfil,P.EliminarPerfil,P.GuardarEquipo,P.BuscarEquipo,P.ModificarEquipo,P.EliminarEquipo,P.NotificaEquipos,P.GuardarMantenimiento,P.BuscarMantenimiento,P.ModificarMantenimiento,P.EliminarMantenimiento,P.Notificaciones_mant_mes,P.Notificaciones_man_ven_mes,P.GuardarCalificacion,P.BuscarCalificacion,P.ModificarCalificacion,P.EliminarCalificacion,P.Notificaciones_calif_mes,P.Notificaciones_calif_ven_mes,P.GuardarCalibracion,P.BuscarCalibracion,P.ModificarCalibracion,P.EliminarCalibracion,P.Notificaciones_calib_mes,P.Notificaciones_calib_ven,P.GuardarMantGen,P.BuscarMantGen,P.ModificarMantGen,P.EliminarMantGen,P.Notificaciones_mantgen_mes,P.Notificaciones_mantgen_vencida FROM Usuario U INNER JOIN PERFIL P ON P.idPerfil=U.idPerfil where U.usuario=? AND U.contrasena=?
users.userByDocument = SELECT U.numeroId,U.idDocumento,U.nombresUsuario,U.apellidosUsuario,U.emailUsuario,U.telefonoUsuario,U.telefono2Usuario,U.celularUsuario,U.usuario,U.contrasena,U.preguntaSeguridad,U.respuestaSeguridad,U.estado as estadoUsuario,P.idPerfil,P.nombrePerfil,P.estado,P.GuardarUsuariao,P.BuscarUsuario,P.ModificarUsuario,P.EliminarUsuario,P.GuardarPerfil,P.BuscarPerfil,P.ModificarPerfil,P.EliminarPerfil,P.GuardarEquipo,P.BuscarEquipo,P.ModificarEquipo,P.EliminarEquipo,P.NotificaEquipos,P.GuardarMantenimiento,P.BuscarMantenimiento,P.ModificarMantenimiento,P.EliminarMantenimiento,P.Notificaciones_mant_mes,P.Notificaciones_man_ven_mes,P.GuardarCalificacion,P.BuscarCalificacion,P.ModificarCalificacion,P.EliminarCalificacion,P.Notificaciones_calif_mes,P.Notificaciones_calif_ven_mes,P.GuardarCalibracion,P.BuscarCalibracion,P.ModificarCalibracion,P.EliminarCalibracion,P.Notificaciones_calib_mes,P.Notificaciones_calib_ven,P.GuardarMantGen,P.BuscarMantGen,P.ModificarMantGen,P.EliminarMantGen,P.Notificaciones_mantgen_mes,P.Notificaciones_mantgen_vencida FROM Usuario U INNER JOIN PERFIL P ON P.idPerfil=U.idPerfil where U.numeroId=?

###Usuarios###
users.validateCreate = Select count(*) as existe FROM Usuario where UPPER(numeroId)=UPPER(?) OR usuario=?
users.createUser = INSERT INTO Usuario (numeroId,idDocumento,nombresUsuario,apellidosUsuario,emailUsuario,telefonoUsuario,telefono2Usuario,celularUsuario,usuario,contrasena,preguntaSeguridad,respuestaSeguridad,idPerfil,estado)VALUES(?,?,?,?,?,?,?,?,?,?,?,?,?,?)
users.updateUser = UPDATE Usuario SET idDocumento=?,nombresUsuario=?,apellidosUsuario=?,emailUsuario=?,telefonoUsuario=?,telefono2Usuario=?,celularUsuario=?,usuario=?,contrasena=?,preguntaSeguridad=?,respuestaSeguridad=?,idPerfil=?,estado=? WHERE numeroId=?
users.findUsers =  SELECT U.numeroId,U.idDocumento,U.nombresUsuario,U.apellidosUsuario,U.emailUsuario,U.telefonoUsuario,U.telefono2Usuario,U.celularUsuario,U.usuario,U.contrasena,U.preguntaSeguridad,U.respuestaSeguridad,U.estado as estadoUsuario,P.idPerfil,P.nombrePerfil,P.estado,P.GuardarUsuariao,P.BuscarUsuario,P.ModificarUsuario,P.EliminarUsuario,P.GuardarPerfil,P.BuscarPerfil,P.ModificarPerfil,P.EliminarPerfil,P.GuardarEquipo,P.BuscarEquipo,P.ModificarEquipo,P.EliminarEquipo,P.NotificaEquipos,P.GuardarMantenimiento,P.BuscarMantenimiento,P.ModificarMantenimiento,P.EliminarMantenimiento,P.Notificaciones_mant_mes,P.Notificaciones_man_ven_mes,P.GuardarCalificacion,P.BuscarCalificacion,P.ModificarCalificacion,P.EliminarCalificacion,P.Notificaciones_calif_mes,P.Notificaciones_calif_ven_mes,P.GuardarCalibracion,P.BuscarCalibracion,P.ModificarCalibracion,P.EliminarCalibracion,P.Notificaciones_calib_mes,P.Notificaciones_calib_ven,P.GuardarMantGen,P.BuscarMantGen,P.ModificarMantGen,P.EliminarMantGen,P.Notificaciones_mantgen_mes,P.Notificaciones_mantgen_vencida FROM Usuario U INNER JOIN PERFIL P ON P.idPerfil=U.idPerfil WHERE 1=1


###Perfiles####
users.profilebyuser = Select P.idPerfil,P.nombrePerfil,P.estado,P.GuardarUsuariao,P.BuscarUsuario,P.ModificarUsuario,P.EliminarUsuario,P.GuardarPerfil,P.BuscarPerfil,P.ModificarPerfil,P.EliminarPerfil,P.GuardarEquipo,P.BuscarEquipo,P.ModificarEquipo,P.EliminarEquipo,P.NotificaEquipos,P.GuardarMantenimiento,P.BuscarMantenimiento,P.ModificarMantenimiento,P.EliminarMantenimiento,P.Notificaciones_mant_mes,P.Notificaciones_man_ven_mes,P.GuardarCalificacion,P.BuscarCalificacion,P.ModificarCalificacion,P.EliminarCalificacion,P.Notificaciones_calif_mes,P.Notificaciones_calif_ven_mes,P.GuardarCalibracion,P.BuscarCalibracion,P.ModificarCalibracion,P.EliminarCalibracion,P.Notificaciones_calib_mes,P.Notificaciones_calib_ven,P.GuardarMantGen,P.BuscarMantGen,P.ModificarMantGen,P.EliminarMantGen,P.Notificaciones_mantgen_mes,P.Notificaciones_mantgen_vencida From perfiles P where P.idPerfil=?
profile.createProfile= INSERT INTO Perfil (nombrePerfil,estado,GuardarUsuariao,BuscarUsuario,ModificarUsuario,EliminarUsuario,GuardarPerfil,BuscarPerfil,ModificarPerfil,EliminarPerfil,GuardarEquipo,BuscarEquipo,ModificarEquipo,EliminarEquipo,NotificaEquipos,GuardarMantenimiento,BuscarMantenimiento,ModificarMantenimiento,EliminarMantenimiento,Notificaciones_mant_mes,Notificaciones_man_ven_mes,GuardarCalificacion,BuscarCalificacion,ModificarCalificacion,EliminarCalificacion,Notificaciones_calif_mes,Notificaciones_calif_ven_mes,GuardarCalibracion,BuscarCalibracion,ModificarCalibracion,EliminarCalibracion,Notificaciones_calib_mes,Notificaciones_calib_ven,GuardarMantGen,BuscarMantGen,ModificarMantGen,EliminarMantGen,Notificaciones_mantgen_mes,Notificaciones_mantgen_vencida) VALUES (?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?,?) 
profile.updateProfile= UPDATE Perfil SET nombrePerfil=?,estado=?,GuardarUsuariao=?,BuscarUsuario=?,ModificarUsuario=?,EliminarUsuario=?,GuardarPerfil=?,BuscarPerfil=?,ModificarPerfil=?,EliminarPerfil=?,GuardarEquipo=?,BuscarEquipo=?,ModificarEquipo=?,EliminarEquipo=?,NotificaEquipos=?,GuardarMantenimiento=?,BuscarMantenimiento=?,ModificarMantenimiento=?,EliminarMantenimiento=?,Notificaciones_mant_mes=?,Notificaciones_man_ven_mes=?,GuardarCalificacion=?,BuscarCalificacion=?,ModificarCalificacion=?,EliminarCalificacion=?,Notificaciones_calif_mes=?,Notificaciones_calif_ven_mes=?,GuardarCalibracion=?,BuscarCalibracion=?,ModificarCalibracion=?,EliminarCalibracion=?,Notificaciones_calib_mes=?,Notificaciones_calib_ven=?,GuardarMantGen=?,BuscarMantGen=?,ModificarMantGen=?,EliminarMantGen=?,Notificaciones_mantgen_mes=?,Notificaciones_mantgen_vencida=? WHERE P.idPerfil=?
profile.findProfiles= SELECT idPerfil,nombrePerfil,estado,GuardarUsuariao,BuscarUsuario,ModificarUsuario,EliminarUsuario,GuardarPerfil,BuscarPerfil,ModificarPerfil,EliminarPerfil,GuardarEquipo,BuscarEquipo,ModificarEquipo,EliminarEquipo,NotificaEquipos,GuardarMantenimiento,BuscarMantenimiento,ModificarMantenimiento,EliminarMantenimiento,Notificaciones_mant_mes,Notificaciones_man_ven_mes,GuardarCalificacion,BuscarCalificacion,ModificarCalificacion,EliminarCalificacion,Notificaciones_calif_mes,Notificaciones_calif_ven_mes,GuardarCalibracion,BuscarCalibracion,ModificarCalibracion,EliminarCalibracion,Notificaciones_calib_mes,Notificaciones_calib_ven,GuardarMantGen,BuscarMantGen,ModificarMantGen,EliminarMantGen,Notificaciones_mantgen_mes,Notificaciones_mantgen_vencida FROM Perfil WHERE 1=1


###Equipos####
equipment.findEquipment = SELECT codigoInventario,codigoMetrologia,numeroSerie,nombreEquipo,marca,modelo,ubicacion,fechaRegistro,clienteRegistro,idTipoEquipo,frecuenciaCalibacion,frecuenciaMantenimiento,frecuenciaCalifiOperativa,frecuenciaCalifiDesempeno,fotoEquipo,extencionFoto,estado,observaciones FROM Equipo where 1=1
equipment.findEquipmentExist = SELECT count(*) as existe FROM Equipo where UPPER(codigoInventario)=UPPER(?) OR UPPER(codigoMetrologia)=UPPER(?) OR UPPER(numeroSerie)=UPPER(?)
equipment.createEquipment = INSERT INTO Equipo(codigoInventario,codigoMetrologia,numeroSerie,nombreEquipo,marca,modelo,ubicacion,fechaRegistro,clienteRegistro,idTipoEquipo,frecuenciaCalibacion,frecuenciaMantenimiento,frecuenciaCalifiOperativa,frecuenciaCalifiDesempeno,fotoEquipo,extencionFoto,estado,observaciones)VALUES(UPPER(?),UPPER(?),UPPER(?),?,?,?,?,GETDATE(),?,?,?,?,?,?,?,?,?,?)
equipment.updateEquipment = UPDATE Equipo SET codigoMetrologia=UPPER(?),ubicacion=?,idTipoEquipo=?,frecuenciaCalibacion=?,frecuenciaMantenimiento=?,frecuenciaCalifiOperativa=?,frecuenciaCalifiDesempeno=?,fotoEquipo=?,estado=?,observaciones=? where UPPER(codigoInventario)=UPPER(?) 
equipment.validChangeTypeManInst = SELECT count(*) as numeroMantenimientos FROM MantenimientoInstrumentos where UPPER(equipoMantenimiento)=UPPER(?)
equipment.validChangeTypeManEquipo = SELECT count(*) as numeroMantenimientos FROM MantenimientoEquipos where UPPER(equipoMantenimiento)=UPPER(?)

###Change register###
changeRegister.find = SELECT E.codigoInventario,R.aplicado,R.cual,U.nombresUsuario+' '+U.apellidosUsuario as solicitado,R.fechaSolicitud,R.area,R.prioridad,R.tipoDocumento,R.otro,R.situacionActual,R.situacionPropuesta,R.razon,R.clasificacion,R.tipoCambio,E.nombreEquipo,R.lote,R.op,R.tamano,R.justificacion,R.idSolicitud FROM RegistroCambios R INNER JOIN Equipo E ON UPPER(R.codigoInventario)=UPPER(E.codigoInventario)INNER JOIN Usuario U ON U.numeroId=R.solicitado where UPPER(idSolicitud)=UPPER(?)
changeRegister.list = SELECT E.codigoInventario,R.aplicado,R.cual,U.nombresUsuario+' '+U.apellidosUsuario as solicitado,R.fechaSolicitud,R.area,R.prioridad,R.tipoDocumento,R.otro,R.situacionActual,R.situacionPropuesta,R.razon,R.clasificacion,R.tipoCambio,E.nombreEquipo,R.lote,R.op,R.tamano,R.justificacion,R.idSolicitud FROM RegistroCambios R INNER JOIN Equipo E ON UPPER(R.codigoInventario)=UPPER(E.codigoInventario)INNER JOIN Usuario U ON U.numeroId=R.solicitado
changeRegister.save = INSERT INTO RegistroCambios (codigoInventario,aplicado,cual,solicitado,fechaSolicitud,area,prioridad,tipoDocumento,otro,situacionActual,situacionPropuesta,razon,clasificacion,tipoCambio,lote,op,tamano,justificacion,idSolicitud) VALUES (?,?,?,?,GETDATE(),?,?,?,?,?,?,?,?,?,?,?,?,?,?)

###Calibration###
equipment.calibration = SELECT codigoCalibracion,equipoCalibracion,division,exactitud,valorMaximo,valorMinimo,rangoCalibracion,rangoTrabajo,proveedor,fechaRegistro,ProximaCalibracion,documentoCalibracion,precioCalibracion FROM Calibracion WHERE UPPER(equipoCalibracion)=UPPER(?)
calibration.save = INSERT INTO Calibracion (equipoCalibracion,division,exactitud,valorMaximo,valorMinimo,rangoCalibracion,rangoTrabajo,proveedor,fechaRegistro,ProximaCalibracion,documentoCalibracion,precioCalibracion) VALUES (?,?,?,?,?,?,?,?,?,?,?,?)

###Maintenance EQUIPMENT###
equipment.maintenanceEquipment = SELECT idMantenimiento,equipoMantenimiento,tipoMantenimiento,responsable,recibido,registrado,anomalias,labores,observaciones,proveedores,fechaRegistr,proximoMantenimiento,precioMantenimiento FROM MantenimientoEquipos WHERE UPPER(equipoMantenimiento)=UPPER(?)
maintenanceEquipment.save = INSERT INTO MantenimientoEquipos (equipoMantenimiento,tipoMantenimiento,responsable,recibido,registrado,anomalias,labores,observaciones,proveedores,fechaRegistr,proximoMantenimiento,precioMantenimiento) VALUES (?,?,?,?,?,?,?,?,?,?,?,?)

###Maintenance INSTRUMENT###
equipment.maintenanceInstrument = SELECT idMantenimiento,equipoMantenimiento,tipoMantenimiento,responsable,recibido,registrado,anomalias,labores,observaciones,proveedores,fechaRegistr,proximoMantenimiento,precioMantenimiento FROM MantenimientoInstrumentos WHERE UPPER(equipoMantenimiento)=UPPER(?)
maintenanceInstrument.save = INSERT INTO MantenimientoInstrumentos (equipoMantenimiento,tipoMantenimiento,responsable,recibido,registrado,anomalias,labores,observaciones,proveedores,fechaRegistr,proximoMantenimiento,precioMantenimiento) VALUES (?,?,?,?,?,?,?,?,?,?,?,?)

###Calification###
equipment.califiation = SELECT equipoCalificacion,calificacionDiseno,calificacionInstalacion,calificacionOperacion,calificacionDesempeno FROM Calificacion WHERE UPPER(equipoCalificacion)=UPPER(?)
califiation.save = INSERT INTO Calificacion (equipoCalificacion,calificacionDiseno,calificacionInstalacion,calificacionOperacion,calificacionDesempeno) VALUES (?,?,?,?,?)

###Program Calification###
califiation.program = INSERT INTO ProgramacionCalificaciones (equipoCalificacion,tipoCalificacion,fechaRegistro,proximaCalificacion,cumplimiento) VALUES (?,?,?,?,?)

